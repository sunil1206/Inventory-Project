{% extends "base.html" %}
{% block title %}Packaging Analytics{% endblock %}
{% block header %}Packaging Analytics{% endblock %}

{% block content %}
<div class="bg-white p-4 rounded-xl shadow mb-6">
    <h3 class="font-semibold mb-3 text-gray-800">Units & Cartons by Product</h3>
    <canvas id="packagingChart" class="w-full h-64 mb-4"></canvas>

    <div class="max-h-96 overflow-y-auto text-sm divide-y">
        {% for row in data %}
            <div class="py-2 flex justify-between">
                <div class="flex-1 pr-2">
                    <p class="font-medium truncate">{{ row.product__name }}</p>
                </div>
                <div class="text-right">
                    <p>{{ row.total_units|default:"0" }} units</p>
                    <p class="text-xs text-gray-500">{{ row.total_cartons|default:"0" }} cartons</p>
                </div>
            </div>
        {% empty %}
            <p class="py-4 text-center text-gray-500">No packaging data.</p>
        {% endfor %}
    </div>
</div>

<script>
    const packLabels = [
        {% for row in data %}
            "{{ row.product__name }}",
        {% endfor %}
    ];
    const packUnits = [
        {% for row in data %}
            {{ row.total_units|default:"0" }},
        {% endfor %}
    ];

    new Chart(document.getElementById("packagingChart"), {
        type: "bar",
        data: {
            labels: packLabels,
            datasets: [{
                label: "Units Ordered",
                data: packUnits,
                backgroundColor: "#f97316"
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: { beginAtZero: true }
            }
        }
    });
</script>
{% endblock %}
