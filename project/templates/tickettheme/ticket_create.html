{% extends "inventory/base.html" %}
{% block title %}Create Ticket{% endblock %}
{% block header %}Create Ticket{% endblock %}

{% block content %}
<div class="max-w-md mx-auto space-y-5">

    <!-- Product block -->
    <div class="bg-white rounded-xl shadow p-4">
        <h2 class="text-base font-semibold text-gray-800 mb-1">{{ product.name }}</h2>

        <p class="text-xs text-gray-500">
            EAN:
            <span class="font-mono">{{ product.barcode }}</span>
        </p>

        {% if product.image_url %}
        <div class="mt-3">
            <img src="{{ product.image_url }}"
                 alt="{{ product.name }}"
                 class="w-20 h-20 object-cover rounded-lg border">
        </div>
        {% endif %}
    </div>

    <!-- Ticket Form -->
    <div class="bg-white rounded-xl shadow p-4">
        <form method="POST" class="space-y-4">
            {% csrf_token %}

            <!-- Store price -->
            <div>
                <label class="block text-xs font-semibold text-gray-700 mb-1">
                    Unit Price (€)
                </label>
                <input type="number"
                       step="0.01"
                       name="price"
                       value="{{ price_entry.price|default:0 }}"
                       class="w-full border rounded-lg px-3 py-2 text-sm">

                {% if not price_entry %}
                    <p class="text-[11px] text-amber-600 mt-1">
                        ⚠️ No price set for this product at this supermarket.
                    </p>
                {% endif %}
            </div>

            <!-- Manual PPL -->
            <div>
                <label class="block text-xs font-semibold text-gray-700 mb-1">
                    Price per Liter / Kg (optional)
                </label>
                <input type="text"
                       name="ppl"
                       value="{{ ticket.price_per_liter|default:'' }}"
                       class="w-full border rounded-lg px-3 py-2 text-sm"
                       placeholder="Auto or leave blank">
            </div>

            <!-- Theme -->
            <div>
                <label class="block text-xs font-semibold text-gray-700 mb-1">
                    Theme
                </label>
                <select name="theme" class="w-full border rounded-lg px-3 py-2 text-sm">
                    <option value="">Default</option>
                    {% for t in themes %}
                        <option value="{{ t.id }}">{{ t.name }}</option>
                    {% endfor %}
                </select>
            </div>

            <!-- Options -->
            <div class="flex items-center gap-2 text-xs">
                <input type="checkbox"
                       id="include_carton"
                       name="include_carton"
                       class="w-4 h-4 rounded border-gray-300">
                <label for="include_carton" class="text-gray-700">
                    Include carton barcode (if available)
                </label>
            </div>

            <button type="submit"
                    class="w-full mt-2 bg-emerald-600 hover:bg-emerald-700
                           text-white py-2.5 rounded-lg text-sm font-semibold">
                ➕ Add Ticket to Queue
            </button>
        </form>
    </div>

</div>
{% endblock %}
