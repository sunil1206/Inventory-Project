{% extends "inventory/base.html" %}

{% block title %}Confirm Delete{% endblock %}
{% block header %}Confirm Product Deletion{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto bg-white p-6 sm:p-8 rounded-lg shadow-sm">

    <!-- Back Link -->
    <div class="mb-6">
        <!-- ✅ FIX: Replaced unreliable logic with a direct and reliable URL tag -->
        <a href="{% url 'inventory:product_list' supermarket.id %}" class="text-sm font-semibold text-blue-600 hover:underline">
            <i class="fas fa-arrow-left mr-2"></i>Cancel and Go Back to Catalog
        </a>
    </div>

    <div class="text-center">
        <i class="fas fa-trash-alt fa-3x text-red-400 mb-4"></i>
        <h1 class="text-3xl font-bold text-gray-800">Are you sure?</h1>
        <p class="text-gray-600 mt-2">You are about to permanently delete the following product from the catalog. This action cannot be undone and will remove it from all inventory records.</p>
    </div>

    <!-- Product Info Card -->
    <div class="mt-8 mb-8 p-4 border rounded-lg flex items-center gap-4 bg-gray-50">
        <img src="{{ product.image_url|default:'https://placehold.co/100x100/F7F7F7/CCC?text=No+Image' }}" alt="{{ product.name }}" class="w-24 h-24 object-contain rounded-md border bg-white">
        <div>
            <h2 class="font-bold text-lg text-gray-800">{{ product.name }}</h2>
            <p class="text-sm text-gray-500">{{ product.brand|default:'No Brand' }}</p>
            <p class="text-xs text-gray-400 mt-1">Barcode: <span class="font-semibold text-gray-600">{{ product.barcode }}</span></p>
        </div>
    </div>

    <!-- Confirmation Form -->
    <form method="POST" action="{% url 'inventory:delete_product' supermarket.id product.barcode %}">
        {% csrf_token %}
        <div class="flex items-center justify-center space-x-4">
            <!-- ✅ FIX: This link now correctly points to the product list -->
            <a href="{% url 'inventory:product_list' supermarket.id %}" class="w-full text-center px-6 py-3 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300">
                Cancel
            </a>
            <button type="submit" class="w-full px-6 py-3 bg-red-600 text-white font-semibold rounded-lg shadow-md hover:bg-red-700">
                Yes, Confirm Delete
            </button>
        </div>
    </form>
</div>
{% endblock %}

