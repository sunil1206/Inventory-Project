{% extends "inventory/base.html" %}

{% block title %}{% if is_editing %}Edit {{ product.name }}{% else %}Create New Product{% endif %}{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto bg-white p-8 rounded-xl shadow-lg">
    <h1 class="text-3xl font-bold text-gray-800 mb-6">
        {% if is_editing %}
            Edit Product Details
        {% else %}
            Create a New Product
        {% endif %}
    </h1>

    <form method="POST" action="{% if is_editing %}{% url 'inventory:edit_product' supermarket.id product.barcode %}{% else %}{% url 'inventory:create_product' supermarket.id %}{% endif %}">
        {% csrf_token %}
        <div class="space-y-6">
            
            <!-- Barcode -->
            <div>
                <label for="id_barcode" class="block text-sm font-medium text-gray-700 mb-1">Barcode (UPC/EAN) <span class="text-red-500">*</span></label>
                <input type="text" name="barcode" id="id_barcode" value="{{ product.barcode|default:'' }}" 
                       {% if is_editing %}readonly{% endif %}
                       required 
                       class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm 
                              {% if is_editing %}bg-gray-100 text-gray-500 cursor-not-allowed{% else %}focus:ring-blue-500 focus:border-blue-500{% endif %}">
                {% if is_editing %}
                <p class="text-xs text-gray-500 mt-1">The barcode cannot be changed after a product is created.</p>
                {% endif %}
            </div>

            <!-- Product Name -->
            <div>
                <label for="id_name" class="block text-sm font-medium text-gray-700 mb-1">Product Name <span class="text-red-500">*</span></label>
                <input type="text" name="name" id="id_name" value="{{ product.name|default:'' }}" required
                       class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
            </div>

            <!-- Brand -->
            <div>
                <label for="id_brand" class="block text-sm font-medium text-gray-700 mb-1">Brand</label>
                <input type="text" name="brand" id="id_brand" value="{{ product.brand|default:'' }}"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
            </div>

            <!-- Description -->
            <div>
                <label for="id_description" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                <textarea name="description" id="id_description" rows="4"
                          class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">{{ product.description|default:'' }}</textarea>
            </div>

        </div>

        <!-- Action Buttons -->
        <div class="mt-8 flex justify-end gap-4">
            {% if is_editing %}
                 <a href="{% url 'inventory:product_detail' supermarket.id product.barcode %}" class="px-4 py-2 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300 transition-colors">
                    Cancel
                </a>
            {% else %}
                 <a href="{% url 'inventory:product_list' supermarket.id %}" class="px-4 py-2 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300 transition-colors">
                    Cancel
                </a>
            {% endif %}

            <button type="submit" class="px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors">
                {% if is_editing %}
                    Save Changes
                {% else %}
                    Create Product
                {% endif %}
            </button>
        </div>
    </form>
</div>
{% endblock %}
